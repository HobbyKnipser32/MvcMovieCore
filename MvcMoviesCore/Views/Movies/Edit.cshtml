@model global::MvcMoviesCore.Models.Movies

@{
    ViewData["Title"] = "Edit Movie";
    var actors = ViewData["Actors"] as IEnumerable<SelectListItem>;
    var roles = ViewData["Roles"] as IEnumerable<SelectListItem>;
}
<div class="container-fluid">
    <h2>Film</h2>

    <h4>bearbeiten</h4>
    <hr />
    <div class="row">
        <div class="col-md-12">
            <form asp-action="Edit">
                <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                <input type="hidden" asp-for="Id" id="movieId" />
                <div class="row">
                    <div class="col-md-12" id="addActor">
                        <div class="row">
                            <div class="col-md-3">
                                <div class="form-floating">
                                    <span class="from-label" for="name">Titel:</span>
                                    <input type="text" asp-for="Name" class="form-control" id="name" />
                                    <span asp-validation-for="Name" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-floating">
                                    <select asp-for="GenreId" class="form-select" asp-items="ViewBag.GenreId" id="genreId"></select>
                                    <label class="from-label" for="genreId">Genre</label>
                                    <span asp-validation-for="GenreId" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-floating">
                                    <select asp-for="RecordCarrierId" class="form-select" asp-items="ViewBag.RecordCarrierId" id="recordCarrierId">
                                        @if (Model.RecordCarrierId == null)
                                        {
                                            <option selected="selected" value=""></option>
                                        }
                                    </select>
                                    <label class="form-label" for="recordCarrierId">Datenträger</label>
                                    <span asp-validation-for="RecordCarrierId" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-floating">
                                    <select asp-for="StorageLocationId" class="form-select" asp-items="ViewBag.StorageLocationId" id="storageLocationId">
                                        @if (Model.StorageLocationId == null)
                                        {
                                            <option selected="selected" value=""></option>
                                        }
                                    </select>
                                    <label class="form-label" for="storageLocationId">Lagerort</label>
                                    <span asp-validation-for="StorageLocationId" class="text-danger"></span>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3">
                                <div class="form-floating">
                                    <span asp-for="YearOfPublication" class="from-label" for="yearOfPublication">erschienen:</span>
                                    <input asp-for="YearOfPublication" class="form-control" type="date" id="yearOfPublication" />
                                    <span asp-validation-for="YearOfPublication" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-floating">
                                    <span class="from-label" for="runTime">Laufzeit:</span>
                                    <input asp-for="RunTime" class="form-control" id="runTime" />
                                    <span asp-validation-for="LastView" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-floating">
                                    <span class="from-label" for="lastView">zuletzt gesehen:</span>
                                    <input asp-for="LastView" class="form-control" type="date" id="lastView" />
                                    <span asp-validation-for="LastView" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-floating">
                                    <span class="from-label" for="owner">Besitzer:</span>
                                    <input asp-for="Owner" class="form-control" id="owner" />
                                    <span asp-validation-for="Owner" class="text-danger"></span>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3">
                                <div class="form-floating">
                                    <span for="onWatch" class="from-label">auf dem Zettel:</span>
                                    <input asp-for="OnWatch" class="form-control" id="onWatch" />
                                    <span asp-validation-for="OnWatch" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-floating">
                                    <span for="added" class="from-label">hinzugefügt:</span>
                                    <input asp-for="Added" class="form-control" type="date" id="added" />
                                    <span asp-validation-for="Added" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-floating">
                                    <span class="from-label" for="remark">Bemerkung:</span>
                                    <input asp-for="Remark" class="form-control" id="remark" />
                                    <span asp-validation-for="Remark" class="text-danger"></span>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-floating">
                                    <span for="shortDescription" class="from-label">Kurzbeschreibung:</span>
                                    <textarea asp-for="ShortDescription" class="form-control" id="shortDescription" ></textarea>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3">
                                <div class="form-floating">
                                    <span for="imdb" class="from-label">IMDB Wertung:</span>
                                    <input asp-for="IMDB" class="form-control" id="imdb" />
                                    <span asp-validation-for="IMDB" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-floating">
                                    <span for="ranking" class="from-label">Wertung:</span>
                                    <input asp-for="Ranking" class="form-control" id="ranking" />
                                    <span asp-validation-for="Ranking" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-floating">
                                    <span for="fileSize" class="from-label">Dateigröße:</span>
                                    <input asp-for="FileSize" class="form-control" id="fileSize" />
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-floating">
                                    <span for="filePath" class="from-label">Dateispeicherort:</span>
                                    <input asp-for="FilePath" class="form-control" id="filePath" />
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3">
                                <div class="form-floating">
                                    <input asp-for="InStock.HasValue" type="checkbox" class="form-checkbox" id="inStock" />
                                    <span class="from-label" for="inStock">vorhanden</span>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-floating">
                                    <input asp-for="Adult" type="checkbox" class="form-checkbox" id="adult" />
                                    <span class="from-label" for="adult">für Erwachsene</span>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-floating">
                                    <input asp-for="ThreeD.HasValue" type="checkbox" class="form-checkbox" id="threeD" />
                                    <span class="from-label" for="threeD">3D</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <hr />
                <div class="row">
                    <div class="col-md-12" id="addActor">
                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-floating">
                                    <select id="newActor" asp-items="@actors" class="form-select" data-live-search="true"></select>
                                    <label class="form-label" for="newActor">Darsteller</label>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-floating">
                                    <select id="newRole" asp-items="@roles" class="select2-dropdown form-control" data-live-search="true"></select>
                                    <label for="newRole" class="form-label">Rolle</label>
                                </div>
                            </div>
                            <div class="col-md-4" style="margin-top:auto;margin-bottom:auto;">
                                <div class="form-floating" style="margin-top:auto; margin-bottom:auto;">
                                    <p>
                                        <a onclick="addActor()" title="Person hinzufügen">
                                            <i class="fa-regular fa-square-plus fa-beat fa-2xl" style="color: #63E6BE; --fa-animation-duration: 2s;"></i>
                                        </a>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <hr />
                <div class="row">
                    <div class="col-md-12" id="addActor">
                        <div class="row col-md-12" id="actorsDiv">
                            <div class="material-datatables table-responsive">
                                <table id="actorsTable" class="table table-striped table-no-bordered table-hover" cellspacing="0" style="word-wrap:break-word; table-layout: auto;">
                                    <thead class="text-rose">
                                        <tr>
                                            <th>Darsteller</th>
                                            <th>Rolle</th>
                                            <th class="disabled-sorting text-right" style="width:5px">&nbsp;</th>
                                        </tr>
                                    </thead>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <hr />
                <div class="row">
                    <div class="form-group col-md-3">
                        <input type="submit" value="Save" class="btn btn-default" />
                    </div>
                </div>
            </form>
        </div>
    </div>

    <div>
        <a asp-action="Index">Back to List</a>
    </div>
</div>
@section Scripts {

    <partial name="_DataTableScripts" />

    <script>
        $(document).ready(function () {
            const movieId = '@Model.Id';
            var actorsTable = $('#actorsTable').DataTable({
                ajax: {
                    url: appRootPath + '/api/MoviesApi/GetActors/' + movieId,
                    dataSrc: ''
                },
                columns: [
                    { data: 'Actor' },
                    { data: 'Role' },
                    {
                        defaultContent: '<a class="btn btn-link btn-default btn-just-icon delete m-0"><i class="fa-solid fa-eraser fa-fade" style="color: #ff0000; --fa-animation-duration: 2s;"></i></a>',
                        className: 'text-right'
                    }
                ],
                paging: false,
                fixedHeader: {
                    header: true,
                    footer: false
                },
                columnDefs: [
                    {
                        targets: [0, 1, 2],
                        searchable: false,
                        className: 'compact'
                    }
                ],
                bFilter: false
            });
        });
    </script>

}